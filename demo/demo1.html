<html>

<head>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.1/dist/leaflet.css" />

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.1/leaflet.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script type="text/javascript" src="../dist/leaflet-regulargridcluster.src.js"></script>
</head>

<style>
#map-content {
  width: 100%;
  height: 100%
}

.marker-cluster {
  opacity: 1 !important
}
</style>


<body>
  <div id="map-content"></div>
  <script>

    // global variables
    var map;

    $( document ).ready(function(){

      var colors = ['#e41a1c','#377eb8','#4daf4a','#984ea3','#ff7f00'];
      var noTestData = 10000;

      // setting map
      map = L.map('map-content').setView([0, 0], 4);

      L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
        opacity: .3
      }).addTo(map);

      var rules = {
        "grid": {
          "fillColor": {
            "method": "sum",
            "attribute": "a",
            "scale": "size",
            "style": ["black", "purple"]
          },
          "weight": {
            "method": "count",
            "attribute": "b",
            "scale": "continuous",
            "style": [0.3, 0.4, 0.9]
          },
          "color": 'black',
          "weight": 3,
        }
      };

      // define RegularGridCluster instance
      var grid = L.regularGridCluster({rules: rules});
      console.log(grid)
      //var grid = new L.geoJSON();

      // boundaries of random data
      var maxX = 50, minX = 0, maxY = 49.5, minY = 0;
      map.fitBounds([[minY, minX], [maxY, maxX]]);

      // putting some random point data
      for (var i=0; i < noTestData; i++) {
        var pointData = {
          x: minX + Math.random() * (maxX - minX),
          y: minY + Math.random() * (maxY - minY),
          type: Math.floor(Math.random() * 5)
        };
        //var circle = L.circleMarker([pointData.y, pointData.x], circleStyle(pointData));

        grid.addElement(
          {
            "type": "Feature",
            "geometry": {
                "type": "Point",
                "coordinates": [pointData.y, pointData.x]
            },
            "properties": {
                "a": Math.floor(Math.random() * 20),
                "b": Math.floor(Math.random() * 10)
            }
          }
        );
      };
      grid.addTo(map);

    })
  </script>
</body>

</html>
